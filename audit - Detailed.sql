
 Insert Into Dataviews set name='Computer Audit - Detailed' ,columnlist='Client,Location,Computer Name,User,Agent Type,Agent OS,OS Version,Agent Install Date,Agent Asset Tag,Agent MAC,Agent Mainboard,Manufacturer,ComputerChassisType,CPUName,CPU Cores,Agent Memory Total,Agent Memory Avail,MemorySlotsUsed,MemorySlotsTotal,VideoCards,NumMonitors,DriveSize,DriveFree' ,fieldlist='Contacts.ContactID as \`ContactID\`, CONCAT(Contacts.FirstName\;\;\' \'\;\;Contacts.LastName) as \`Contact\`, Contacts.Email as \`Contact Email\`, Contacts.Phone as \`Contact Phone\`, Contacts.Cell as \`Contact Cell\`, Contacts.Address1 as \`Contact Address1\`, Contacts.Address2 as \`Contact Address2\`, Contacts.City as \`Contact City\`, Contacts.State as \`Contact State\`, Contacts.Zip as \`Contact Zipcode\`, Contacts.Fax as \`Contact Fax\`, Contacts.Pager as \`Contact Pager\`, Contacts.MSN as \`Contact MSN\`, Contacts.AIM as \`Contact AIM\`, Contacts.ICQ as \`Contact ICQ\`, Contacts.NetBiosName as \`Contact Netbios\`, Clients.ClientID as \`ClientID\`, Clients.Name as \`Client\`, Clients.Address1 as \`Client Address\`, Clients.City as \`Client City\`, Clients.State as \`Client State\`, Clients.Zip as \`Client Zipcode\`, Clients.Address2 as \`Client Address2\`, CONVERT(IF(Clients.SupportMins>0\;\;Clients.SupportMins\;\;IF(Clients.SupportMins=0\;\;\'None\'\;\;\'Unlimited\')) using UTF8) as \`Client SupportMins\`, Clients.Phone as \`Clients Phone\`, Clients.Fax as \`Clients Fax\`, Clients.Country as \`Clients Country\`, Locations.LocationID as \`LocationID\`, CONCAT(Clients.Name\;\;\'/\'\;\;Locations.Name) as \`Client Location\`, Locations.Name as \`Location\`, Locations.Address as \`Location Address\`, Locations.City as \`Location City\`, Locations.State as \`Location State\`, Locations.Zip as \`Location Zipcode\`, Locations.Phone as \`Location Phone\`, Locations.Fax as \`Location Fax\`, Locations.Country as \`Location Country\`, Locations.Router as \`Location Router\`, Locations.RouterPort as \`Location Router Port\`, Computers.Version as \`OS Version\`, Computers.ServiceVersion as \`Agent Version\`, computers.Comment as \`Agent Comment\`, Computers.LastContact as \`Agent Last Contact Date\`, Computers.LastInventory as \`Agent Last Inventory Date\`, Computers.CPUUsage as \`Agent CPU Usage\`, Computers.TotalMemory as \`Agent Memory Total\`, Computers.MemoryAvail as \`Agent Memory Avail\`, Computers.RouterAddress as \`Agent Router Address\`, Computers.Uptime as \`Agent Uptime\`, Computers.DataIn as \`Agent Bytes IN\`, Computers.DataOut as \`Agent Bytes Out\`, Computers.MAC as \`Agent MAC\`, Computers.DateAdded as \`Agent Install Date\`, Computers.BiosName as \`Agent Mainboard\`, Computers.BiosVer as \`Agent Serial Number\`, Computers.BiosFlash as \`Agent Bios\`, Convert(IF(INSTR(Computers.Username\;\;\'\;\;\')>0\;\;LEFT(Computers.Username\;\;Instr(Computers.UserName\;\;\'\;\;\')-1)\;\;Computers.Username) using utf8) as \`User\`, Computers.OS as \`Agent OS\`, Computers.Domain as \`Agent Windows Domain\`, Computers.BiosMFG as \`Manufacturer\`, Computers.LocalAddress as \`Agent IP Address\`, Computers.AssetTag as \`Agent Asset Tag\`, Computers.AssetDate as \`Agent Asset Date\`, CONVERT(IF(Computers.LastContact>DATE_ADD(NOW()\;\;interval -7 Minute)\;\;\'Online\'\;\;\'Offline\') using utf8) as \`Status\`, CONVERT(IF(Computers.OS like \'%darwin%\'\;\;\'True\'\;\;\'False\') using utf8) as \`Agent Apple\`, CONVERT(IF(Computers.OS like \'%windows ce%\'\;\;\'True\'\;\;\'False\') using utf8) as \`Agent Mobile\`, CONVERT(IF(Computers.OS like \'%nix%\'\;\;\'True\'\;\;\'False\') using utf8) as \`Agent Unix\`, CONVERT(IF(Computers.BiosFlash like \'%portable%\'\;\;\'True\'\;\;\'False\') using utf8) as \`Agent Laptop\`, CONVERT(IF((Computers.Flags & 1)=1\;\;\'True\'\;\;\'False\') using utf8) as \`Agent FasTalk\`, CONVERT(IF((Computers.Flags & 16)=16\;\;\'True\'\;\;\'False\') using utf8) as \`Master PC\`, CONVERT(IF((Computers.Flags & 32)=32\;\;\'True\'\;\;\'False\') using utf8) as \`Agent Monitors Running\`, CONVERT(IF((Computers.Flags & 128)=128\;\;\'True\'\;\;\'False\') using utf8) as \`Probe PC\`, CONVERT(IF((Computers.Flags & 256)=256\;\;\'True\'\;\;\'False\') using utf8) as \`Agent ShadowProtect Detected\`, Convert(IF(Computers.OS like \'%server%\'\;\;\'Server\'\;\;IF(Computers.BiosFlash like \'%portable%\'\;\;\'Laptop\'\;\;\'WorkStation\')) using utf8) as \`Agent Type\`, Computers.WindowsUpdate as \`Agent Windows Update\`, Computers.Windir as \`Agent Windows Directory\`, computers.\`name\` as \`Computer Name\`, v_extradatacomputers.\`friendlyname\` as \`Friendly Name\`, v_xr_computers.\`ComputerChassisType\` as \`ComputerChassisType\`, v_xr_computers.\`ComputerDriveSize\` as \`DriveSize\`, v_xr_computers.\`ComputerDriveFree\` as \`DriveFree\`, v_xr_computerhardware.\`MemorySlotsUsed\` as \`MemorySlotsUsed\`, v_xr_computerhardware.\`MemorySlotsTotal\` as \`MemorySlotsTotal\`, v_xr_computerhardware.\`VideoCards\` as \`VideoCards\`, v_xr_computerhardware.\`Monitors\` as \`NumMonitors\`, v_xr_computerhardware.\`CPUName\` as \`CPUName\`, v_processors.\`cores\` as \`CPU Cores\`' ,hiddenlist='' ,sqlbody='FROM (((((((computers JOIN locations ON computers.locationid=locations.locationid) JOIN clients ON computers.clientid=clients.clientid) LEFT JOIN contacts ON computers.contactid=contacts.contactid) LEFT JOIN v_extradatacomputers ON computers.computerid=v_extradatacomputers.computerid) LEFT JOIN v_xr_computers ON computers.computerid=v_xr_computers.computerid) LEFT JOIN v_xr_computerhardware ON computers.computerid=v_xr_computerhardware.computerid) LEFT JOIN v_processors ON computers.computerid=v_processors.computerid)' ,groupField='Client' ,sortField='Agent OS' ,sortOrder='0' ,sqlwhere='' ,idColumn='Computers.ComputerID' ,formatControl='Agent CPU Usage,A,,,2,,0,,%,3,90,1,FF0000,,1|Agent Memory Total,A,,,1,,0,,mb|Agent Memory Avail,A,,,1,,0,,mb|Agent Uptime,A,,,1,,0,, mins|Agent MAC,A,,,2,,0,,|' ,filterControl='Agent Apple,0,0,,1|Agent Mobile,0,0,,1|Agent Unix,0,0,,1|Agent Laptop,0,0,,1|Agent FasTalk,0,0,,1|Agent Monitors Running,0,0,,1|Agent ShadowProtect Detected,0,0,,1|' ,iconControl='29|' ,GUID='1373aaeb-1c0f-4ccf-8e2c-2138d5b1a3e6');
